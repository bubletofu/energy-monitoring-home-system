2025-04-04 21:13:08,361 - INFO - Bước 1: Kiểm tra cấu hình môi trường...
2025-04-04 21:13:08,463 - INFO - Loading .env from: /Users/nhi/Documents/school/takedata/backend/.env
2025-04-04 21:13:08,464 - INFO - Environment variables:
2025-04-04 21:13:08,464 - INFO - DATABASE_URL from env: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 21:13:08,464 - INFO - ALGORITHM from env: HS256
2025-04-04 21:13:08,464 - INFO - ACCESS_TOKEN_EXPIRE_MINUTES from env: 30
2025-04-04 21:13:08,467 - INFO - Settings loaded successfully
2025-04-04 21:13:08,467 - INFO - Final Database URL being used: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 21:13:08,467 - INFO - Final Algorithm being used: HS256
2025-04-04 21:13:08,467 - INFO - Final Token expire minutes: 30
2025-04-04 21:13:08,467 - INFO - Đã tải cấu hình từ config.py
2025-04-04 21:13:08,467 - INFO - Bước 2: Kiểm tra kết nối đến cơ sở dữ liệu...
2025-04-04 21:13:08,552 - INFO - Kết nối đến cơ sở dữ liệu thành công!
2025-04-04 21:13:08,552 - INFO - Bước 3: Thiết lập các bảng...
2025-04-04 21:13:08,600 - INFO - Đã tải các model từ models.py
2025-04-04 21:13:08,622 - INFO - Các bảng hiện có trong cơ sở dữ liệu: original_samples, users, device_configs, devices, sensor_data, compressed_data_optimized
2025-04-04 21:13:08,622 - INFO - Tất cả các bảng cần thiết đã được tạo thành công!
2025-04-04 21:13:08,622 - INFO - Thiết lập cơ sở dữ liệu thành công!
2025-04-04 22:37:07,000 - INFO - Bước 1: Kiểm tra cấu hình môi trường...
2025-04-04 22:37:07,116 - INFO - Loading .env from: /Users/nhi/Documents/school/takedata/backend/.env
2025-04-04 22:37:07,117 - INFO - Environment variables:
2025-04-04 22:37:07,117 - INFO - DATABASE_URL from env: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:37:07,117 - INFO - ALGORITHM from env: HS256
2025-04-04 22:37:07,118 - INFO - ACCESS_TOKEN_EXPIRE_MINUTES from env: 30
2025-04-04 22:37:07,120 - INFO - Settings loaded successfully
2025-04-04 22:37:07,120 - INFO - Final Database URL being used: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:37:07,120 - INFO - Final Algorithm being used: HS256
2025-04-04 22:37:07,120 - INFO - Final Token expire minutes: 30
2025-04-04 22:37:07,120 - INFO - Đã tải cấu hình từ config.py
2025-04-04 22:37:07,120 - INFO - Bước 2: Kiểm tra kết nối đến cơ sở dữ liệu...
2025-04-04 22:37:07,190 - INFO - Kết nối đến cơ sở dữ liệu thành công!
2025-04-04 22:37:07,190 - INFO - Bước 3: Thiết lập các bảng...
2025-04-04 22:37:07,238 - INFO - Đã tải các model từ models.py
2025-04-04 22:37:07,259 - INFO - Các bảng hiện có trong cơ sở dữ liệu: original_samples, users, device_configs, devices, sensor_data, compressed_data_optimized
2025-04-04 22:37:07,260 - INFO - Tất cả các bảng cần thiết đã được tạo thành công!
2025-04-04 22:37:07,260 - INFO - Bước 5: Chạy các file migration...
2025-04-04 22:37:07,261 - INFO - Đang thực thi migration: 02-change-original-data-to-value.sql
2025-04-04 22:37:07,274 - ERROR - Lỗi khi thực thi migration /Users/nhi/Documents/school/takedata/backend/migrations/02-change-original-data-to-value.sql: (psycopg2.errors.SyntaxError) syntax error at or near "RENAME"
LINE 4:     RENAME COLUMN original_data TO value; 
            ^

[SQL: -- Đổi tên và kiểu dữ liệu cột
ALTER TABLE original_samples 
    ALTER COLUMN original_data TYPE NUMERIC(10,2) USING (original_data::numeric),
    RENAME COLUMN original_data TO value; ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 22:37:07,274 - ERROR - Migration thất bại: 02-change-original-data-to-value.sql. Dừng quá trình migration.
2025-04-04 22:37:07,274 - INFO - Đã thực thi 0/3 migration thành công
2025-04-04 22:37:07,274 - INFO - Thiết lập cơ sở dữ liệu thành công!
2025-04-04 22:37:58,820 - INFO - Bước 1: Kiểm tra cấu hình môi trường...
2025-04-04 22:37:58,896 - INFO - Loading .env from: /Users/nhi/Documents/school/takedata/backend/.env
2025-04-04 22:37:58,897 - INFO - Environment variables:
2025-04-04 22:37:58,897 - INFO - DATABASE_URL from env: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:37:58,897 - INFO - ALGORITHM from env: HS256
2025-04-04 22:37:58,897 - INFO - ACCESS_TOKEN_EXPIRE_MINUTES from env: 30
2025-04-04 22:37:58,899 - INFO - Settings loaded successfully
2025-04-04 22:37:58,899 - INFO - Final Database URL being used: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:37:58,899 - INFO - Final Algorithm being used: HS256
2025-04-04 22:37:58,899 - INFO - Final Token expire minutes: 30
2025-04-04 22:37:58,899 - INFO - Đã tải cấu hình từ config.py
2025-04-04 22:37:58,899 - INFO - Bước 2: Kiểm tra kết nối đến cơ sở dữ liệu...
2025-04-04 22:37:58,964 - INFO - Kết nối đến cơ sở dữ liệu thành công!
2025-04-04 22:37:58,964 - INFO - Bước 3: Thiết lập các bảng...
2025-04-04 22:37:59,010 - INFO - Đã tải các model từ models.py
2025-04-04 22:37:59,030 - INFO - Các bảng hiện có trong cơ sở dữ liệu: original_samples, users, device_configs, devices, sensor_data, compressed_data_optimized
2025-04-04 22:37:59,030 - INFO - Tất cả các bảng cần thiết đã được tạo thành công!
2025-04-04 22:37:59,030 - INFO - Bước 5: Chạy các file migration...
2025-04-04 22:37:59,031 - INFO - Đang thực thi migration: 02-change-original-data-to-value.sql
2025-04-04 22:37:59,043 - ERROR - Lỗi khi thực thi migration /Users/nhi/Documents/school/takedata/backend/migrations/02-change-original-data-to-value.sql: (psycopg2.errors.SyntaxError) syntax error at or near "RENAME"
LINE 4:     RENAME COLUMN original_data TO value; 
            ^

[SQL: -- Đổi tên và kiểu dữ liệu cột
ALTER TABLE original_samples 
    ALTER COLUMN original_data TYPE NUMERIC(10,2) USING (original_data::numeric),
    RENAME COLUMN original_data TO value; ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 22:37:59,043 - ERROR - Migration thất bại: 02-change-original-data-to-value.sql. Dừng quá trình migration.
2025-04-04 22:37:59,043 - INFO - Đã thực thi 0/3 migration thành công
2025-04-04 22:37:59,043 - INFO - Thiết lập cơ sở dữ liệu thành công!
2025-04-04 22:39:17,321 - INFO - Bước 1: Kiểm tra cấu hình môi trường...
2025-04-04 22:39:17,404 - INFO - Loading .env from: /Users/nhi/Documents/school/takedata/backend/.env
2025-04-04 22:39:17,405 - INFO - Environment variables:
2025-04-04 22:39:17,405 - INFO - DATABASE_URL from env: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:39:17,405 - INFO - ALGORITHM from env: HS256
2025-04-04 22:39:17,405 - INFO - ACCESS_TOKEN_EXPIRE_MINUTES from env: 30
2025-04-04 22:39:17,407 - INFO - Settings loaded successfully
2025-04-04 22:39:17,407 - INFO - Final Database URL being used: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:39:17,407 - INFO - Final Algorithm being used: HS256
2025-04-04 22:39:17,407 - INFO - Final Token expire minutes: 30
2025-04-04 22:39:17,407 - INFO - Đã tải cấu hình từ config.py
2025-04-04 22:39:17,407 - INFO - Bước 2: Kiểm tra kết nối đến cơ sở dữ liệu...
2025-04-04 22:39:17,475 - INFO - Kết nối đến cơ sở dữ liệu thành công!
2025-04-04 22:39:17,475 - INFO - Bước 3: Thiết lập các bảng...
2025-04-04 22:39:17,517 - INFO - Đã tải các model từ models.py
2025-04-04 22:39:17,536 - INFO - Các bảng hiện có trong cơ sở dữ liệu: original_samples, users, device_configs, devices, sensor_data, compressed_data_optimized
2025-04-04 22:39:17,536 - INFO - Tất cả các bảng cần thiết đã được tạo thành công!
2025-04-04 22:39:17,536 - INFO - Bước 5: Chạy các file migration...
2025-04-04 22:39:17,537 - INFO - Đang thực thi migration: 02-change-original-data-to-value.sql
2025-04-04 22:39:17,552 - ERROR - Lỗi khi thực thi migration /Users/nhi/Documents/school/takedata/backend/migrations/02-change-original-data-to-value.sql: (psycopg2.errors.SyntaxError) syntax error at or near "RENAME"
LINE 5:     RENAME COLUMN original_data TO value;
            ^

[SQL: -- Đổi tên và kiểu dữ liệu cột, lấy giá trị từ JSONB
ALTER TABLE original_samples 
    ALTER COLUMN original_data TYPE NUMERIC(10,2) 
    USING (original_data->>'value')::numeric,
    RENAME COLUMN original_data TO value;

-- Thêm index cho cột value mới
CREATE INDEX IF NOT EXISTS idx_original_samples_value ON original_samples(value); ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-04-04 22:39:17,552 - ERROR - Migration thất bại: 02-change-original-data-to-value.sql. Dừng quá trình migration.
2025-04-04 22:39:17,552 - INFO - Đã thực thi 0/3 migration thành công
2025-04-04 22:39:17,552 - INFO - Thiết lập cơ sở dữ liệu thành công!
2025-04-04 22:39:45,462 - INFO - Bước 1: Kiểm tra cấu hình môi trường...
2025-04-04 22:39:45,542 - INFO - Loading .env from: /Users/nhi/Documents/school/takedata/backend/.env
2025-04-04 22:39:45,543 - INFO - Environment variables:
2025-04-04 22:39:45,543 - INFO - DATABASE_URL from env: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:39:45,543 - INFO - ALGORITHM from env: HS256
2025-04-04 22:39:45,543 - INFO - ACCESS_TOKEN_EXPIRE_MINUTES from env: 30
2025-04-04 22:39:45,545 - INFO - Settings loaded successfully
2025-04-04 22:39:45,545 - INFO - Final Database URL being used: postgresql://postgres:1234@localhost:5433/iot_db
2025-04-04 22:39:45,545 - INFO - Final Algorithm being used: HS256
2025-04-04 22:39:45,545 - INFO - Final Token expire minutes: 30
2025-04-04 22:39:45,545 - INFO - Đã tải cấu hình từ config.py
2025-04-04 22:39:45,545 - INFO - Bước 2: Kiểm tra kết nối đến cơ sở dữ liệu...
2025-04-04 22:39:45,619 - INFO - Kết nối đến cơ sở dữ liệu thành công!
2025-04-04 22:39:45,619 - INFO - Bước 3: Thiết lập các bảng...
2025-04-04 22:39:45,664 - INFO - Đã tải các model từ models.py
2025-04-04 22:39:45,683 - INFO - Các bảng hiện có trong cơ sở dữ liệu: original_samples, users, device_configs, devices, sensor_data, compressed_data_optimized
2025-04-04 22:39:45,683 - INFO - Tất cả các bảng cần thiết đã được tạo thành công!
2025-04-04 22:39:45,683 - INFO - Bước 5: Chạy các file migration...
2025-04-04 22:39:45,684 - INFO - Đang thực thi migration: 02-change-original-data-to-value.sql
2025-04-04 22:39:45,733 - INFO - Đã thực thi migration thành công: /Users/nhi/Documents/school/takedata/backend/migrations/02-change-original-data-to-value.sql
2025-04-04 22:39:45,733 - INFO - Đang thực thi migration: drop_compressed_data_table.sql
2025-04-04 22:39:45,770 - INFO - Đã thực thi migration thành công: /Users/nhi/Documents/school/takedata/backend/migrations/drop_compressed_data_table.sql
2025-04-04 22:39:45,770 - INFO - Đang thực thi migration: drop_test_tables.sql
2025-04-04 22:39:45,783 - INFO - Đã thực thi migration thành công: /Users/nhi/Documents/school/takedata/backend/migrations/drop_test_tables.sql
2025-04-04 22:39:45,783 - INFO - Đã thực thi 3/3 migration thành công
2025-04-04 22:39:45,783 - INFO - Đã chạy thành công 3 migration!
2025-04-04 22:39:45,783 - INFO - Thiết lập cơ sở dữ liệu thành công!
